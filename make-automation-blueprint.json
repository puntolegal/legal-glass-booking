{
  "name": "Punto Legal - Sistema de Notificaciones Completo",
  "description": "Automatización completa para agendamiento de citas con notificaciones automáticas",
  "version": "1.0.0",
  "created": "2025-01-07T00:00:00.000Z",
  "updated": "2025-01-07T00:00:00.000Z",
  "scenario": {
    "id": "punto-legal-automation",
    "name": "Sistema de Notificaciones Completo",
    "description": "Automatización para procesar citas y enviar notificaciones",
    "modules": [
      {
        "id": "webhook-1",
        "name": "Nueva Cita Recibida",
        "type": "webhook",
        "position": {
          "x": 100,
          "y": 200
        },
        "config": {
          "url": "{{webhook_url}}",
          "method": "POST",
          "response": "JSON",
          "headers": {
            "Content-Type": "application/json"
          }
        },
        "data": {
          "cliente": {
            "nombre": "string",
            "email": "string",
            "telefono": "string"
          },
          "servicio": {
            "nombre": "string",
            "precio": "number",
            "duracion": "number"
          },
          "cita": {
            "fecha": "string",
            "hora": "string",
            "notas": "string"
          }
        }
      },
      {
        "id": "google-calendar-1",
        "name": "Crear Evento en Calendar",
        "type": "google-calendar",
        "position": {
          "x": 400,
          "y": 200
        },
        "config": {
          "action": "createAnEvent",
          "calendar": "primary",
          "summary": "Consulta Legal - {{cliente.nombre}}",
          "description": "Cliente: {{cliente.nombre}}\nEmail: {{cliente.email}}\nTeléfono: {{cliente.telefono}}\nServicio: {{servicio.nombre}}\nNotas: {{cita.notas}}",
          "start": "{{cita.fecha}}T{{cita.hora}}:00",
          "end": "{{cita.fecha}}T{{cita.hora}}:00",
          "location": "Google Meet - Enlace será enviado por email",
          "attendees": ["{{cliente.email}}"]
        }
      },
      {
        "id": "gmail-1",
        "name": "Email Confirmación Cliente",
        "type": "gmail",
        "position": {
          "x": 700,
          "y": 200
        },
        "config": {
          "action": "SendEmail",
          "to": "{{cliente.email}}",
          "subject": "Confirmación de Cita - Punto Legal",
          "body": "{{email_template_confirmacion}}",
          "isHtml": true
        }
      },
      {
        "id": "gmail-2",
        "name": "Email Notificación Abogado",
        "type": "gmail",
        "position": {
          "x": 700,
          "y": 400
        },
        "config": {
          "action": "SendEmail",
          "to": "abogado@puntolegal.cl",
          "subject": "Nueva Cita Programada - {{cliente.nombre}}",
          "body": "{{email_template_abogado}}",
          "isHtml": true
        }
      },
      {
        "id": "supabase-1",
        "name": "Guardar en Base de Datos",
        "type": "supabase",
        "position": {
          "x": 400,
          "y": 400
        },
        "config": {
          "action": "insertRecord",
          "table": "reservations",
          "data": {
            "cliente_nombre": "{{cliente.nombre}}",
            "cliente_email": "{{cliente.email}}",
            "cliente_telefono": "{{cliente.telefono}}",
            "servicio_nombre": "{{servicio.nombre}}",
            "servicio_precio": "{{servicio.precio}}",
            "cita_fecha": "{{cita.fecha}}",
            "cita_hora": "{{cita.hora}}",
            "cita_notas": "{{cita.notas}}",
            "estado": "confirmada",
            "created_at": "{{now}}"
          }
        }
      }
    ],
    "connections": [
      {
        "from": "webhook-1",
        "to": "google-calendar-1",
        "type": "success",
        "label": "Nueva Reserva"
      },
      {
        "from": "google-calendar-1",
        "to": "gmail-1",
        "type": "success",
        "label": "Evento Creado"
      },
      {
        "from": "gmail-1",
        "to": "gmail-2",
        "type": "success",
        "label": "Notificación Abogado"
      },
      {
        "from": "webhook-1",
        "to": "supabase-1",
        "type": "success",
        "label": "Guardar Datos"
      }
    ],
    "variables": {
      "webhook_url": "https://hook.eu1.make.com/YOUR_WEBHOOK_ID",
      "email_template_confirmacion": "<!DOCTYPE html><html><head><title>Confirmación de Cita</title></head><body><h1>¡Hola {{cliente.nombre}}!</h1><p>Tu cita ha sido confirmada para el {{cita.fecha}} a las {{cita.hora}}.</p><p>Servicio: {{servicio.nombre}}</p><p>Gracias por confiar en Punto Legal.</p></body></html>",
      "email_template_abogado": "<!DOCTYPE html><html><head><title>Nueva Cita</title></head><body><h1>Nueva Cita Programada</h1><p><strong>Cliente:</strong> {{cliente.nombre}}</p><p><strong>Email:</strong> {{cliente.email}}</p><p><strong>Teléfono:</strong> {{cliente.telefono}}</p><p><strong>Servicio:</strong> {{servicio.nombre}}</p><p><strong>Fecha:</strong> {{cita.fecha}} {{cita.hora}}</p><p><strong>Notas:</strong> {{cita.notas}}</p></body></html>"
    }
  },
  "settings": {
    "execution": {
      "mode": "immediate",
      "retry": {
        "enabled": true,
        "maxAttempts": 3,
        "delay": 300
      }
    },
    "notifications": {
      "email": {
        "enabled": true,
        "address": "admin@puntolegal.cl"
      },
      "webhook": {
        "enabled": false
      }
    }
  },
  "metadata": {
    "author": "Punto Legal",
    "version": "1.0.0",
    "tags": ["legal", "appointments", "automation"],
    "requirements": {
      "google-calendar": "API access required",
      "gmail": "SMTP access required",
      "supabase": "Database connection required"
    }
  }
} 